# ==========================================
# ARQUIVO: .env.example
# ==========================================

# ConfiguraÃ§Ãµes da IA AvanÃ§ada
AI_API_URL=https://ia-trading-bot-nrn1.onrender.com
AI_API_KEY=seu_api_key_aqui

# ConfiguraÃ§Ãµes Deriv API
DERIV_WS_URL=wss://ws.derivws.com/websockets/v3?app_id=1089
DERIV_API_TOKEN="cNAlmhMbfcfbTu0"

# ConfiguraÃ§Ãµes do App
NODE_ENV=development
ELECTRON_ENABLE_LOGGING=true
ELECTRON_ENABLE_STACK_DUMPING=true

# ConfiguraÃ§Ãµes de Trading
DEFAULT_STAKE=1.00
DEFAULT_SYMBOL=R_50
MARTINGALE_MAX_LEVEL=8
AUTO_SAVE_INTERVAL=30000

# ConfiguraÃ§Ãµes de Desenvolvimento
DEBUG_MODE=false
SHOW_DEV_TOOLS=false
HOT_RELOAD=true

# ==========================================
# ARQUIVO: test/basic.test.js
# ==========================================

const { spawn } = require('child_process');
const path = require('path');
const fs = require('fs');

describe('ğŸ§ª IA DERIV AvanÃ§ada - Testes BÃ¡sicos', () => {
  
  test('âœ… Arquivos principais existem', () => {
    const requiredFiles = [
      'main.js',
      'preload.js', 
      'index.html',
      'package.json'
    ];
    
    requiredFiles.forEach(file => {
      expect(fs.existsSync(file)).toBe(true);
      console.log(`âœ… ${file} existe`);
    });
  });
  
  test('âœ… Sintaxe JavaScript vÃ¡lida', () => {
    const jsFiles = ['main.js', 'preload.js'];
    
    jsFiles.forEach(file => {
      expect(() => {
        require(path.join(process.cwd(), file));
      }).not.toThrow();
      console.log(`âœ… ${file} sintaxe OK`);
    });
  });
  
  test('âœ… package.json vÃ¡lido', () => {
    const packageJson = require('../package.json');
    
    expect(packageJson.name).toBe('ia-deriv-avancada');
    expect(packageJson.main).toBe('main.js');
    expect(packageJson.scripts.start).toBeDefined();
    expect(packageJson.scripts['build-win']).toBeDefined();
    
    console.log('âœ… package.json estrutura OK');
  });
  
  test('âœ… DependÃªncias instaladas', () => {
    expect(fs.existsSync('node_modules')).toBe(true);
    expect(fs.existsSync('node_modules/electron')).toBe(true);
    expect(fs.existsSync('node_modules/electron-builder')).toBe(true);
    
    console.log('âœ… DependÃªncias principais instaladas');
  });
  
  test('âœ… Assets criados', () => {
    expect(fs.existsSync('assets')).toBe(true);
    
    if (fs.existsSync('assets/icon.svg')) {
      console.log('âœ… Ãcone SVG criado');
    }
  });
  
  test('â±ï¸ App inicia sem erros crÃ­ticos (timeout 30s)', async () => {
    return new Promise((resolve, reject) => {
      const timeout = setTimeout(() => {
        if (electronProcess && !electronProcess.killed) {
          electronProcess.kill();
        }
        reject(new Error('Timeout: App nÃ£o iniciou em 30 segundos'));
      }, 30000);
      
      const electronProcess = spawn('npx', ['electron', '.', '--test-mode'], {
        stdio: 'pipe',
        detached: false
      });
      
      let hasStarted = false;
      
      electronProcess.stdout.on('data', (data) => {
        const output = data.toString();
        console.log('STDOUT:', output);
        
        if (output.includes('IA DERIV') || output.includes('Electron')) {
          hasStarted = true;
          clearTimeout(timeout);
          electronProcess.kill();
          resolve();
        }
      });
      
      electronProcess.stderr.on('data', (data) => {
        const error = data.toString();
        console.log('STDERR:', error);
        
        // Ignorar avisos nÃ£o crÃ­ticos
        if (!error.includes('WARNING') && !error.includes('deprecated')) {
          clearTimeout(timeout);
          electronProcess.kill();
          reject(new Error(`Erro crÃ­tico: ${error}`));
        }
      });
      
      electronProcess.on('close', (code) => {
        clearTimeout(timeout);
        if (!hasStarted && code !== 0) {
          reject(new Error(`App fechou com cÃ³digo ${code}`));
        } else if (hasStarted) {
          resolve();
        }
      });
    });
  }, 35000);
  
});

console.log('ğŸš€ Executando testes do IA DERIV AvanÃ§ada...');

# ==========================================
# ARQUIVO: docs/TECHNICAL.md
# ==========================================

# ğŸ“‹ DocumentaÃ§Ã£o TÃ©cnica - IA DERIV AvanÃ§ada

## ğŸ—ï¸ Arquitetura do Sistema

### Processo Principal (Main Process)
- **Arquivo**: `main.js`
- **Responsabilidade**: Gerenciamento de janelas, menus, armazenamento local
- **Tecnologias**: Electron Main, Node.js APIs

### Processo Renderizador (Renderer Process)  
- **Arquivo**: `index.html` + JavaScript integrado
- **Responsabilidade**: Interface usuÃ¡rio, lÃ³gica de trading, IA
- **Tecnologias**: HTML5, CSS3, JavaScript ES6+

### Bridge de SeguranÃ§a
- **Arquivo**: `preload.js`
- **Responsabilidade**: ComunicaÃ§Ã£o segura entre Main e Renderer
- **SeguranÃ§a**: Context isolation, IPC restrito

## ğŸ§  Sistema de IA AvanÃ§ada

### Q-Learning
```javascript
Estado = {
  sÃ­mbolo: string,
  volatilidade: number,
  horÃ¡rio: number,
  resultado_anterior: boolean
}

AÃ§Ã£o = "CALL" | "PUT" | "WAIT"
Recompensa = P&L_do_trade
```

### InversÃ£o Adaptativa
- **Threshold Inicial**: 3 erros consecutivos
- **AdaptaÃ§Ã£o**: Baseada na performance histÃ³rica
- **LÃ³gica**: Se erros >= threshold â†’ inverter sinais

### Aprendizado ContÃ­nuo
- **Temporal**: PadrÃµes por horÃ¡rio/dia
- **Sequencial**: SequÃªncias de trades
- **Correlacional**: RelaÃ§Ãµes entre sÃ­mbolos

## ğŸ”— IntegraÃ§Ã£o APIs

### Deriv WebSocket API
```javascript
const ws = new WebSocket('wss://ws.derivws.com/websockets/v3?app_id=1089');

// AutenticaÃ§Ã£o
ws.send(JSON.stringify({ authorize: token }));

// Trading
ws.send(JSON.stringify({
  buy: 1,
  price: stake,
  parameters: {
    contract_type: "CALL",
    symbol: "R_50",
    duration: 5,
    duration_unit: "t"
  }
}));
```

### IA AvanÃ§ada API
```javascript
const response = await fetch('https://ia-trading-bot-nrn1.onrender.com/signal', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${API_KEY}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify(marketData)
});
```

## ğŸ’¾ Armazenamento de Dados

### Electron Store
```javascript
const Store = require('electron-store');
const store = new Store({
  defaults: {
    apiToken: '',
    martingaleSettings: {},
    aiSettings: {},
    tradingHistory: []
  }
});
```

### Estrutura de Dados
```
%APPDATA%/ia-deriv-config/
â”œâ”€â”€ config.json          # ConfiguraÃ§Ãµes principais
â”œâ”€â”€ trading-history.json # HistÃ³rico de trades
â”œâ”€â”€ ai-learning-data.json # Dados de aprendizado IA
â””â”€â”€ logs/                # Logs da aplicaÃ§Ã£o
```

## ğŸ›¡ï¸ Sistema Anti-DuplicaÃ§Ã£o

### Controles Rigorosos
```javascript
let orderLock = false;
let hasActiveOrder = false;
let processingOrder = false;
let orderCooldown = false;

function canPlaceNewOrder() {
  return !orderLock && !hasActiveOrder && 
         !processingOrder && !orderCooldown;
}
```

### Timeouts e Cleanup
- **Order Timeout**: 5 minutos para finalizaÃ§Ã£o
- **Cooldown**: 3 segundos entre ordens
- **Force Cleanup**: Reset completo se necessÃ¡rio

## ğŸ° Sistema Martingale

### ProgressÃ£o
```javascript
const martingaleState = {
  level: 0,          // NÃ­vel atual (0-8)
  baseStake: 1.00,   // Stake base
  maxLevel: 8,       // MÃ¡ximo permitido
  multiplier: 2      // Multiplicador (2x)
};

// CÃ¡lculo prÃ³ximo stake
nextStake = baseStake * Math.pow(multiplier, level);
```

### Reset AutomÃ¡tico
- **WIN**: Reset imediato para nÃ­vel 0
- **MAX LEVEL**: Reset forÃ§ado por seguranÃ§a

## ğŸ”§ Build e DistribuiÃ§Ã£o

### Electron Builder
```json
{
  "win": {
    "target": ["nsis", "portable", "zip"],
    "arch": ["x64", "ia32"]
  },
  "nsis": {
    "oneClick": false,
    "allowToChangeInstallationDirectory": true
  }
}
```

### Artefatos Gerados
- `IA-DERIV-Avancada-Setup-1.0.0.exe` - Instalador
- `IA-DERIV-Avancada-Portable-1.0.0.exe` - PortÃ¡til
- `IA-DERIV-Avancada-1.0.0-x64.exe` - 64-bit
- `IA-DERIV-Avancada-1.0.0-ia32.exe` - 32-bit

## ğŸ› Debug e Logs

### Development Tools
```bash
# Modo desenvolvimento
npm run dev

# Debug main process
--inspect=9229

# Debug renderer
F12 (DevTools)
```

### Logging
```javascript
console.log('ğŸš€ Info');
console.warn('âš ï¸ Warning'); 
console.error('âŒ Error');
```

## ğŸ“Š MÃ©tricas e Monitoramento

### KPIs Principais
- **Win Rate**: Taxa de acerto dos trades
- **P&L**: Lucro/PrejuÃ­zo acumulado
- **Sharpe Ratio**: RelaÃ§Ã£o risco/retorno
- **Drawdown**: Maior perda consecutiva

### Coleta de Dados
```javascript
const sessionStats = {
  totalTrades: 0,
  wonTrades: 0,
  lostTrades: 0,
  totalPnL: 0,
  startBalance: 0
};
```

## ğŸ”’ SeguranÃ§a

### Context Isolation
```javascript
// preload.js
contextBridge.exposeInMainWorld('electronAPI', {
  // APIs seguras apenas
});
```

### CSP (Content Security Policy)
```html
<meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; 
               connect-src 'self' wss://ws.derivws.com https://ia-trading-bot-nrn1.onrender.com;">
```

### ValidaÃ§Ã£o de Dados
- SanitizaÃ§Ã£o de inputs
- ValidaÃ§Ã£o de tokens
- VerificaÃ§Ã£o de integridade

## ğŸš€ Performance

### OtimizaÃ§Ãµes
- Lazy loading de componentes
- Debounce em eventos frequentes
- Cache de dados da IA
- Cleanup automÃ¡tico de memÃ³ria

### Monitoramento
```javascript
// Uso de memÃ³ria
process.memoryUsage();

// Performance timing
console.time('operaÃ§Ã£o');
// ... cÃ³digo
console.timeEnd('operaÃ§Ã£o');
```

# ==========================================
# ARQUIVO: .eslintrc.js
# ==========================================

module.exports = {
  env: {
    browser: true,
    commonjs: true,
    es6: true,
    node: true
  },
  extends: [
    'eslint:recommended'
  ],
  globals: {
    electronAPI: 'readonly',
    tradingConfig: 'readonly'
  },
  parserOptions: {
    ecmaVersion: 2020,
    sourceType: 'module'
  },
  rules: {
    'indent': ['error', 2],
    'linebreak-style': ['error', 'windows'],
    'quotes': ['error', 'single'],
    'semi': ['error', 'always'],
    'no-console': 'off',
    'no-unused-vars': ['warn', { 
      "argsIgnorePattern": "^_" 
    }],
    'no-undef': 'error',
    'prefer-const': 'error',
    'no-var': 'error'
  },
  ignorePatterns: [
    'node_modules/',
    'dist/',
    'build/',
    '*.min.js'
  ]
};

# ==========================================
# ARQUIVO: CONTRIBUTING.md
# ==========================================

# ğŸ¤ Contribuindo para IA DERIV AvanÃ§ada

## ğŸ¯ Como Contribuir

### 1. ğŸ´ Fork do RepositÃ³rio
```bash
git clone https://github.com/seu-usuario/ia-deriv-avancada.git
cd ia-deriv-avancada
```

### 2. ğŸŒ¿ Criar Branch
```bash
git checkout -b feature/nova-funcionalidade
# ou
git checkout -b fix/correcao-bug
```

### 3. ğŸ’» Desenvolver
- Siga os padrÃµes de cÃ³digo
- Adicione testes se necessÃ¡rio
- Documente mudanÃ§as significativas

### 4. âœ… Testar
```bash
npm test
npm run build-win
```

### 5. ğŸ“¤ Pull Request
- Descreva as mudanÃ§as claramente
- Referencie issues relacionadas
- Aguarde review

## ğŸ“‹ PadrÃµes de CÃ³digo

### JavaScript
- Use `const`/`let` ao invÃ©s de `var`
- Prefira arrow functions
- Use template literals
- Comente cÃ³digo complexo

### Commits
```
feat: adicionar nova funcionalidade IA
fix: corrigir bug no martingale
docs: atualizar documentaÃ§Ã£o
style: formataÃ§Ã£o de cÃ³digo
```

### Issues
- Use templates disponÃ­veis
- Seja especÃ­fico e detalhado
- Inclua steps para reproduzir bugs

## ğŸ§ª Testes

### Executar Testes
```bash
npm test
```

### Adicionar Testes
```javascript
test('âœ… Nova funcionalidade', () => {
  // Seu teste aqui
});
```

## ğŸ“ DocumentaÃ§Ã£o

- Atualize README.md se necessÃ¡rio
- Documente APIs novas
- Adicione exemplos de uso

## ğŸš€ Ãreas PrioritÃ¡rias

1. **ğŸ§  Melhorias na IA**
   - Algoritmos mais sofisticados
   - OtimizaÃ§Ã£o de performance
   - Novos indicadores

2. **ğŸ¨ Interface**
   - Melhorias de UX
   - Novos temas
   - Responsividade

3. **ğŸ“Š Analytics**
   - RelatÃ³rios avanÃ§ados
   - VisualizaÃ§Ãµes
   - ExportaÃ§Ã£o de dados

4. **ğŸ”§ Infraestrutura**
   - OtimizaÃ§Ãµes de build
   - CI/CD melhorias
   - DocumentaÃ§Ã£o

## â“ DÃºvidas?

- Abra uma issue
- Entre no Discord
- Envie email para dev@iatrading.com

Obrigado por contribuir! ğŸ™